<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../utils/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="../utils/toastr.min.css">
    <link rel="stylesheet" href="../utils/mdb/css/mdb-sass.css">
    <title>VehShop</title>
</head>

<body>

    <div id="VehicleShopCEFBox">
        <p class="closebtn" onclick="CloseVehicleShopCEF();"><i class="fas fa-times"></i></p>
        <p id="VehicleShopCEFBox-title">Fahrzeugshop: NAME</p>
        <hr>
        <input class="VehSearch" type="text" id="VehSearch" placeholder="Suchen..." onkeyup="VehSearch()"/>
        <ul id="VehicleShopCEFBox-StoreList" class="list-group"></ul>
    </div>
    <script>
        function VehSearch() {
            var input, filter, ul, li, a, i, txtValue;
            input = document.getElementById("VehSearch");
            filter = input.value.toUpperCase();
            ul = document.getElementById("VehicleShopCEFBox-StoreList");
            li = ul.getElementsByTagName("li");
            for (i = 0; i < li.length; i++) {
                a = li[i].getElementsByTagName("span")[0];
                txtValue = a.textContent || a.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    li[i].style.display = "";
                } else {
                    li[i].style.display = "none";
                }
            }
        }
        </script>
    </div>

    <script src="../utils/jquery-3.4.1.min.js"></script>
    <script src="../utils/jquery-ui.min.js"></script>
    <script src="../utils/popper.min.js"></script>
    <script src="../utils/bootstrap.min.js"></script>
    <script src="../utils/mdb/js/mdb.min.js"></script>
    <script src="../utils/anime.min.js"></script>
    <script src="../utils/toastr.js"></script>
    <script defer src="../utils/fontawesome/js/all.js"></script>
</body>

<script>
    var curVehShopId = undefined;

    $(document).ready(function () {
        alt.emit("Client:HUD:cefIsReady");
    });

    function SetVehicleShopCEFListContent(shopid, shopname, itemarray) {
        var vehshophtml = "",
            itemarray = JSON.parse(itemarray);

        for (var i in itemarray) {
            vehshophtml += `<li class='list-group-item'><img src='../utils/img/vehicles/${itemarray[i].hash}.png'><span><b>Fahrzeugname: </b>${itemarray[i].name}</span><br><span><b>Hersteller: </b>${itemarray[i].manufactor}</span><br>` +
                `<span><b>Treibstoff: </b>${itemarray[i].fueltype}</span><br><span><b>Tankgröße: </b>${itemarray[i].maxfuel} Liter</span><br><span><b>Kofferraum: </b>${itemarray[i].trunkcapacity}kg</span><br>` +
                `<span><b>Sitzplätze: </b>${itemarray[i].seats}</span><br><span><b>Preis: </b>${itemarray[i].price}$</span>` +
                "<span class='buybtn' onclick='VehicleShopCEFBuyItem(`" + itemarray[i].hash + "`);'><i class='fas fa-dollar-sign'></i></span></li>";
        }

        $("#VehicleShopCEFBox-title").html(`${shopname}`);
        $("#VehicleShopCEFBox-StoreList").html(vehshophtml);
        $("#VehicleShopCEFBox").fadeTo(1000, 1, function() {});
    }

    function VehicleShopCEFBuyItem(hash) {
        alt.emit("Client:VehicleShop:BuyVehicle", curVehShopId, hash);
        CloseVehicleShopCEF();
    }

    function CloseVehicleShopCEF() {
        $("#VehicleShopCEFBox").fadeOut(500, function () {
            $("#VehicleShopCEFBox").hide();
            curVehShopId = undefined;
        });
        alt.emit("Client:VehicleShop:destroyVehicleShopCEF");
    }
</script>
<script type="text/javascript">
    alt.on("CEF:General:hideAllCEFs", (hideCursor) => {
        $("#VehicleShopCEFBox").fadeOut(500, function () {
            $("#VehicleShopCEFBox").hide();
            curVehShopId = undefined;
        });
    });

    alt.on("CEF:VehicleShop:SetListContent", (shopid, shopname, itemarray) => {
        SetVehicleShopCEFListContent(shopid, shopname, itemarray);
        curVehShopId = shopid;
    });
</script>

</html>